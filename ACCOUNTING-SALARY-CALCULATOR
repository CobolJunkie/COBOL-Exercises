IDENTIFICATION DIVISION.
PROGRAM-ID. ACCOUNTING-SALARY-CALCULATOR.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
   SELECT EMPLOYEE-FILE ASSIGN TO "EMPLOYEE.DAT".
   SELECT PAYROLL-FILE ASSIGN TO "PAYROLL.DAT".

DATA DIVISION.
FILE SECTION.
FD EMPLOYEE-FILE.
   01 EMPLOYEE-RECORD.
      02 EMP-ID       PIC 9(5).
      02 EMP-NAME     PIC X(20).
      02 EMP-DEPARTMENT PIC X(10).
      02 EMP-SALARY   PIC 9(5).

FD PAYROLL-FILE.
   01 PAYROLL-RECORD.
      02 DEPARTMENT-TOTAL  PIC 9(10).

WORKING-STORAGE SECTION.
   01 DEPARTMENT-SUMMARY.
      02 DEPARTMENT-NAME  PIC X(10).
      02 DEPARTMENT-TOTAL PIC 9(10).

PROCEDURE DIVISION.
   OPEN INPUT EMPLOYEE-FILE.
   OPEN OUTPUT PAYROLL-FILE.

   READ EMPLOYEE-FILE
      AT END SET END-OF-FILE TO TRUE
      NOT AT END PERFORM UNTIL END-OF-FILE
         ADD EMPLOYEE-RECORD.EMP-SALARY TO DEPARTMENT-SUMMARY.DEPARTMENT-TOTAL
            GIVING DEPARTMENT-SUMMARY.DEPARTMENT-TOTAL
         END-ADD
         READ EMPLOYEE-FILE
   END-PERFORM.

   CLOSE EMPLOYEE-FILE.
   CLOSE PAYROLL-FILE.

   STOP RUN.
